<!-- 
dev log

a web based dashboard
- Daily data entry form (cleaner than Excel)
- Daily data entry with categories (revenue, expenses, investments)
- All data stored by date, accessible anytime
- Dashboard with filters (day/week/month/year)
- Auto calculations for totals, profits, etc.
- Dashboard with charts and breakdowns
- Daily/weekly/monthly/yearly filters
- Date range picker
- Everything runs in the browser (localStorage)
- Works on any device
- Pre-loaded with sample data so you can see how it looks

Theme: Red and Black Dark Mode
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Red & Black Finance Dashboard</title>
  <!-- Import Chart.js for visualizations -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
  <style>
    /* Base Reset & Theme Variables */
    :root {
      --bg-color: #0a0a0a;
      --surface-color: #141414;
      --surface-hover: #1f1f1f;
      --primary-color: #d32f2f; /* Red */
      --primary-hover: #b71c1c;
      --text-main: #e0e0e0;
      --text-muted: #a0a0a0;
      --border-color: #333;
      --success-color: #4caf50;
      --danger-color: #f44336;
      --font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-main);
      font-family: var(--font-family);
      margin: 0;
      padding: 0;
      line-height: 1.6;
    }

    /* Layout Containers */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      border-bottom: 1px solid var(--primary-color);
      padding-bottom: 20px;
    }

    h1 { margin: 0; font-size: 1.8rem; color: var(--primary-color); text-transform: uppercase; letter-spacing: 1px; }

    /* Navbar Tabs */
    .nav-tabs {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
    }
    .nav-tab-btn {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1rem;
      cursor: pointer;
      padding: 8px 12px;
      transition: color 0.2s;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
    }
    .nav-tab-btn:hover { color: var(--text-main); }
    .nav-tab-btn.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      margin-bottom: -11px; /* Pull down to align with border */
    }

    /* Buttons */
    button {
      cursor: pointer;
      border: none;
      border-radius: 4px;
      padding: 10px 20px;
      font-weight: 600;
      transition: all 0.2s;
      font-family: inherit;
    }

    .btn-primary {
      background-color: var(--primary-color);
      color: white;
    }
    .btn-primary:hover { background-color: var(--primary-hover); }

    .btn-outline {
      background-color: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-muted);
    }
    .btn-outline:hover, .btn-outline.active {
      border-color: var(--primary-color);
      color: var(--primary-color);
      background-color: rgba(211, 47, 47, 0.1);
    }

    .btn-danger-text {
      background: none;
      color: var(--danger-color);
      padding: 5px;
    }
    .btn-danger-text:hover { text-decoration: underline; }

    /* Controls / Filters */
    .controls-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      margin-bottom: 30px;
      background: var(--surface-color);
      padding: 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
    }

    .filter-group { display: flex; gap: 5px; }

    input[type="date"], select, input[type="text"], input[type="number"] {
      background-color: var(--bg-color);
      border: 1px solid var(--border-color);
      color: var(--text-main);
      padding: 8px 12px;
      border-radius: 4px;
      font-family: inherit;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    /* Dashboard Grid */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .card {
      background-color: var(--surface-color);
      padding: 20px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .card h3 { margin: 0 0 10px 0; font-size: 0.9rem; color: var(--text-muted); text-transform: uppercase; }
    .card .value { font-size: 1.8rem; font-weight: bold; }
    .val-rev { color: var(--success-color); }
    .val-exp { color: var(--danger-color); }
    .val-inv { color: #2196f3; }
    .val-prof { color: var(--text-main); }

    /* Charts Section */
    .charts-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 30px;
    }
    @media (max-width: 768px) { .charts-container { grid-template-columns: 1fr; } }
    .chart-wrapper {
      background: var(--surface-color);
      padding: 20px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      height: 350px;
      position: relative;
    }

    /* Table Section */
    .table-container {
      background: var(--surface-color);
      border-radius: 8px;
      border: 1px solid var(--border-color);
      overflow-x: auto;
    }
    table { width: 100%; border-collapse: collapse; min-width: 600px; }
    th, td { text-align: left; padding: 15px; border-bottom: 1px solid var(--border-color); }
    th { color: var(--text-muted); font-weight: 600; font-size: 0.85rem; text-transform: uppercase; }
    tr:hover { background-color: var(--surface-hover); }
    
    /* Modal */
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex; justify-content: center; align-items: center;
      z-index: 1000;
      opacity: 0; pointer-events: none;
      transition: opacity 0.3s;
    }
    .modal-overlay.open { opacity: 1; pointer-events: all; }
    .modal {
      background: var(--surface-color);
      padding: 30px;
      border-radius: 8px;
      width: 90%; max-width: 500px;
      border: 1px solid var(--primary-color);
      box-shadow: 0 10px 25px rgba(0,0,0,0.5);
    }
    .form-group { margin-bottom: 15px; }
    .form-group label { display: block; margin-bottom: 5px; color: var(--text-muted); }
    .form-group input, .form-group select { width: 100%; box-sizing: border-box; }
    .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }

    /* Utility */
    .tag {
      padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; font-weight: bold; text-transform: uppercase;
    }
    .tag-revenue { background: rgba(76, 175, 80, 0.2); color: var(--success-color); }
    .tag-expense { background: rgba(244, 67, 54, 0.2); color: var(--danger-color); }
    .tag-investment { background: rgba(33, 150, 243, 0.2); color: #2196f3; }

  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>FinDash <span style="color:white; font-size:0.6em;">v1.0</span></h1>
    <button class="btn-primary" id="addEntryBtn">+ New Entry</button>
  </header>

  <!-- Navbar -->
  <nav class="nav-tabs">
    <button id="tabHomeBtn" class="nav-tab-btn active" onclick="switchTab('home')">Home</button>
    <button id="tabListBtn" class="nav-tab-btn" onclick="switchTab('list')">List</button>
  </nav>

  <!-- VIEW: HOME -->
  <div id="homeViewEl">
    <!-- Filters -->
    <div class="controls-bar">
      <div class="filter-group">
        <button class="btn-outline active" onclick="setFilter('today')">Today</button>
        <button class="btn-outline" onclick="setFilter('week')">This Week</button>
        <button class="btn-outline" onclick="setFilter('month')">This Month</button>
        <button class="btn-outline" onclick="setFilter('year')">This Year</button>
        <button class="btn-outline" onclick="setFilter('all')">All Time</button>
      </div>
      <div style="flex-grow: 1;"></div>
      <div class="filter-group">
        <input type="date" id="dateStartInput">
        <span style="color:var(--text-muted)">to</span>
        <input type="date" id="dateEndInput">
      </div>
      <button class="btn-outline" onclick="applyCustomRange()">Apply</button>
    </div>

    <!-- Summary Cards -->
    <div class="dashboard-grid">
      <div class="card">
        <h3>Total Revenue</h3>
        <div class="value val-rev" id="totalRevEl">$0.00</div>
      </div>
      <div class="card">
        <h3>Total Expenses</h3>
        <div class="value val-exp" id="totalExpEl">$0.00</div>
      </div>
      <div class="card">
        <h3>Investments</h3>
        <div class="value val-inv" id="totalInvEl">$0.00</div>
      </div>
      <div class="card">
        <h3>Net Profit</h3>
        <div class="value val-prof" id="netProfitEl">$0.00</div>
      </div>
    </div>

    <!-- Charts -->
    <div class="charts-container">
      <div class="chart-wrapper">
        <canvas id="breakdownChart"></canvas>
      </div>
      <div class="chart-wrapper">
        <canvas id="trendChart"></canvas>
      </div>
    </div>
  </div>

  <!-- VIEW: LIST -->
  <div id="listViewEl" hidden>
    <!-- Recent Transactions Table -->
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Category</th>
            <th>Description</th>
            <th style="text-align:right;">Amount</th>
            <th style="text-align:center;">Action</th>
          </tr>
        </thead>
        <tbody id="tableBodyEl">
          <!-- Rows injected via JS -->
        </tbody>
      </table>
    </div>
  </div>

</div>

<!-- Modal Form -->
<div class="modal-overlay" id="modalOverlay">
  <div class="modal">
    <h2 style="margin-top:0; color:var(--primary-color);">Add New Entry</h2>
    <form id="entryForm">
      <div class="form-group">
        <label>Date</label>
        <input type="date" id="formDate" required>
      </div>
      <div class="form-group">
        <label>Type</label>
        <select id="formType" required>
          <option value="revenue">Revenue</option>
          <option value="expense">Expense</option>
          <option value="investment">Investment</option>
        </select>
      </div>
      <div class="form-group">
        <label>Description</label>
        <input type="text" id="formDesc" placeholder="e.g. Client Payment, Server Costs" required>
      </div>
      <div class="form-group">
        <label>Amount</label>
        <input type="number" id="formAmount" placeholder="0.00" step="0.01" min="0" required>
      </div>
      <div class="modal-actions">
        <button type="button" class="btn-outline" id="cancelBtn">Cancel</button>
        <button type="submit" class="btn-primary">Save Entry</button>
      </div>
    </form>
  </div>
</div>

<script>
  // --- State Management ---
  const STORAGE_KEY = 'finance_dashboard_data';
  let allData = [];
  let filteredData = [];
  let breakdownChartInstance = null;
  let trendChartInstance = null;

  // --- Init ---
  function init() {
    loadData();
    
    // Set default date inputs to current month
    const today = new Date();
    const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
    dateStartInput.value = firstDay.toISOString().split('T')[0];
    dateEndInput.value = today.toISOString().split('T')[0];

    // Initial render (defaulting to Month view for better initial data visualization)
    setFilter('month');

    // Listeners
    addEntryBtn.onclick = openModal;
    cancelBtn.onclick = closeModal;
    modalOverlay.onclick = (e) => { if(e.target === modalOverlay) closeModal(); };
    entryForm.onsubmit = handleFormSubmit;
  }

  // --- Data Handling ---
  function loadData() {
    let stored = localStorage[STORAGE_KEY];
    if (stored) {
      allData = JSON.parse(stored);
    } else {
      // Pre-load sample data if empty
      generateSampleData();
    }
  }

  function saveData() {
    localStorage[STORAGE_KEY] = JSON.stringify(allData);
  }

  function generateSampleData() {
    const categories = ['revenue', 'expense', 'investment'];
    const descriptions = {
      revenue: ['Client Project A', 'Consulting Fee', 'Product Sale', 'Ad Revenue'],
      expense: ['Server Costs', 'Software License', 'Office Supplies', 'Marketing Ads', 'Coffee'],
      investment: ['Stock Purchase', 'Crypto', 'Bond Fund']
    };
    
    const today = new Date();
    allData = [];

    // Generate data for last 30 days
    for (let i = 0; i < 40; i++) {
      const date = new Date(today);
      date.setDate(date.getDate() - Math.floor(Math.random() * 30));
      
      const type = categories[Math.floor(Math.random() * categories.length)];
      const descList = descriptions[type];
      const desc = descList[Math.floor(Math.random() * descList.length)];
      
      // Amounts logic
      let amount = 0;
      if (type === 'revenue') amount = Math.floor(Math.random() * 800) + 100;
      if (type === 'expense') amount = Math.floor(Math.random() * 150) + 10;
      if (type === 'investment') amount = Math.floor(Math.random() * 500) + 50;

      allData.push({
        id: Date.now() + i,
        date: date.toISOString().split('T')[0],
        type: type,
        description: desc,
        amount: parseFloat(amount.toFixed(2))
      });
    }
    
    // Sort by date descending
    allData.sort((a, b) => new Date(b.date) - new Date(a.date));
    saveData();
  }

  // --- Filtering Logic ---
  function setFilter(preset) {
    // Update UI buttons
    document.querySelectorAll('.filter-group button').forEach(b => b.classList.remove('active'));
    event?.target?.classList.add('active'); // Optional chaining in case called programmatically

    const start = new Date();
    const end = new Date();

    if (preset === 'today') {
      // Same start/end
    } else if (preset === 'week') {
      start.setDate(start.getDate() - start.getDay()); // Sunday
    } else if (preset === 'month') {
      start.setDate(1);
    } else if (preset === 'year') {
      start.setMonth(0, 1);
    } else if (preset === 'all') {
      start.setFullYear(start.getFullYear() - 10); // Just way back
    }

    // Update date inputs to match preset
    if(preset !== 'all') {
      dateStartInput.value = start.toISOString().split('T')[0];
      dateEndInput.value = end.toISOString().split('T')[0];
    } else {
      // For 'all', just grab the earliest date in data
      if(allData.length > 0) {
         // Find earliest date
         const dates = allData.map(d => new Date(d.date).getTime());
         const min = new Date(Math.min(...dates));
         dateStartInput.value = min.toISOString().split('T')[0];
      }
    }

    applyCustomRange(); // Re-use the logic
  }

  function applyCustomRange() {
    const startStr = dateStartInput.value;
    const endStr = dateEndInput.value;
    
    if(!startStr || !endStr) return;

    const startDate = new Date(startStr);
    const endDate = new Date(endStr);
    // Set end date to end of day for inclusive comparison
    endDate.setHours(23, 59, 59, 999);

    filteredData = allData.filter(item => {
      const itemDate = new Date(item.date);
      return itemDate >= startDate && itemDate <= endDate;
    });

    // Sort filtered data for display (Newest first)
    filteredData.sort((a, b) => new Date(b.date) - new Date(a.date));

    updateUI();
  }

  // --- UI Updates ---
  function updateUI() {
    calculateTotals();
    renderTable();
    renderCharts();
  }

  function calculateTotals() {
    let rev = 0, exp = 0, inv = 0;
    
    filteredData.forEach(d => {
      if (d.type === 'revenue') rev += d.amount;
      else if (d.type === 'expense') exp += d.amount;
      else if (d.type === 'investment') inv += d.amount;
    });

    totalRevEl.textContent = formatMoney(rev);
    totalExpEl.textContent = formatMoney(exp);
    totalInvEl.textContent = formatMoney(inv);
    
    const profit = rev - exp;
    netProfitEl.textContent = formatMoney(profit);
    netProfitEl.style.color = profit >= 0 ? 'var(--success-color)' : 'var(--danger-color)';
  }

  function renderTable() {
    tableBodyEl.innerHTML = '';
    filteredData.forEach(item => {
      const tr = document.createElement('tr');
      const amountClass = item.type === 'revenue' ? 'val-rev' : (item.type === 'expense' ? 'val-exp' : 'val-inv');
      const sign = item.type === 'revenue' ? '+' : '-';
      
      tr.innerHTML = `
        <td>${item.date}</td>
        <td><span class="tag tag-${item.type}">${item.type}</span></td>
        <td>${item.description}</td>
        <td style="text-align:right;" class="${amountClass}">${sign}${formatMoney(item.amount)}</td>
        <td style="text-align:center;">
          <button class="btn-danger-text" onclick="deleteEntry(${item.id})">Delete</button>
        </td>
      `;
      tableBodyEl.appendChild(tr);
    });
    
    if(filteredData.length === 0) {
      tableBodyEl.innerHTML = '<tr><td colspan="5" style="text-align:center; color:var(--text-muted);">No records found for this date range.</td></tr>';
    }
  }

  function renderCharts() {
    // 1. Breakdown Chart (Doughnut)
    const totals = { revenue: 0, expense: 0, investment: 0 };
    filteredData.forEach(d => totals[d.type] += d.amount);

    const ctx1 = breakdownChart.getContext('2d');
    if (breakdownChartInstance) breakdownChartInstance.destroy();
    
    breakdownChartInstance = new Chart(ctx1, {
      type: 'doughnut',
      data: {
        labels: ['Revenue', 'Expenses', 'Investments'],
        datasets: [{
          data: [totals.revenue, totals.expense, totals.investment],
          backgroundColor: ['#4caf50', '#f44336', '#2196f3'],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: 'right', labels: { color: '#e0e0e0' } },
          title: { display: true, text: 'Cash Flow Breakdown', color: '#e0e0e0' }
        }
      }
    });

    // 2. Trend Chart (Bar - Daily)
    // Group by date
    const dateMap = {};
    // We need to iterate in reverse for the chart (oldest to newest)
    const chartData = [...filteredData].sort((a, b) => new Date(a.date) - new Date(b.date));
    
    chartData.forEach(d => {
      if (!dateMap[d.date]) dateMap[d.date] = { revenue: 0, expense: 0 };
      if (d.type === 'revenue') dateMap[d.date].revenue += d.amount;
      if (d.type === 'expense') dateMap[d.date].expense += d.amount;
    });

    const labels = Object.keys(dateMap);
    const revData = labels.map(l => dateMap[l].revenue);
    const expData = labels.map(l => dateMap[l].expense);

    const ctx2 = trendChart.getContext('2d');
    if (trendChartInstance) trendChartInstance.destroy();

    trendChartInstance = new Chart(ctx2, {
      type: 'bar',
      data: {
        labels: labels,
        datasets: [
          { label: 'Revenue', data: revData, backgroundColor: '#4caf50' },
          { label: 'Expenses', data: expData, backgroundColor: '#f44336' }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { labels: { color: '#e0e0e0' } },
          title: { display: true, text: 'Daily Trend', color: '#e0e0e0' }
        },
        scales: {
          x: { ticks: { color: '#a0a0a0' }, grid: { color: '#333' } },
          y: { ticks: { color: '#a0a0a0' }, grid: { color: '#333' } }
        }
      }
    });
  }

  // --- Tab Switching Logic ---
  function switchTab(tabName) {
    const homeView = homeViewEl;
    const listView = listViewEl;
    const homeBtn = tabHomeBtn;
    const listBtn = tabListBtn;

    if (tabName === 'home') {
      homeView.hidden = false;
      listView.hidden = true;
      homeBtn.classList.add('active');
      listBtn.classList.remove('active');
      // Resize charts if needed when showing
      if(breakdownChartInstance) breakdownChartInstance.resize();
      if(trendChartInstance) trendChartInstance.resize();
    } else {
      homeView.hidden = true;
      listView.hidden = false;
      homeBtn.classList.remove('active');
      listBtn.classList.add('active');
    }
  }

  // --- Form Handling ---
  function openModal() {
    // Set default date to today
    formDate.value = new Date().toISOString().split('T')[0];
    modalOverlay.classList.add('open');
  }

  function closeModal() {
    modalOverlay.classList.remove('open');
    entryForm.reset();
  }

  function handleFormSubmit(e) {
    e.preventDefault();
    
    const newEntry = {
      id: Date.now(),
      date: formDate.value,
      type: formType.value,
      description: formDesc.value,
      amount: parseFloat(formAmount.value)
    };

    allData.push(newEntry);
    saveData();
    closeModal();
    applyCustomRange(); // Refresh current view
  }

  function deleteEntry(id) {
    if(!confirm('Are you sure you want to delete this entry?')) return;
    allData = allData.filter(item => item.id !== id);
    saveData();
    applyCustomRange();
  }

  // --- Helpers ---
  function formatMoney(amount) {
    return '$' + amount.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
  }

  // Start App
  init();

</script>
</body>
</html>